; ------------------------------------------------
;  Falling into a Schwarzschild black hole
;
;
;   the v-coordinate is not correct for r<rs !!
;
; ------------------------------------------------

(define  obsInitPos  10.0)
(define  objInitPos  6.0)

(define posList (vector 
(vector   0.00000000  10.00000000  27.69456145    0.00000000)
(vector   0.10000000   9.99995000  27.66493576    0.00111804)
(vector   0.20000000   9.99980000  27.63560122    0.00223610)
(vector   0.30000000   9.99954999  27.60655622    0.00335421)
(vector   0.40000000   9.99919997  27.57779956    0.00447239)
(vector   0.50000000   9.99874994  27.54932976    0.00559066)
(vector   0.60000000   9.99819989  27.52114634    0.00670901)
(vector   0.70000000   9.99754980  27.49324655    0.00782752)
(vector   0.80000000   9.99679966  27.46562965    0.00894618)
(vector   0.90000000   9.99594945  27.43829435    0.01006502)
(vector   1.00000000   9.99499917  27.41123938    0.01118407)
(vector   1.10000000   9.99394878  27.38446349    0.01230334)
(vector   1.20000000   9.99279827  27.35796544    0.01342285)
(vector   1.30000000   9.99154762  27.33174404    0.01454264)
(vector   1.40000000   9.99019680  27.30579808    0.01566271)
(vector   1.50000000   9.98874578  27.28012642    0.01678310)
(vector   1.60000000   9.98719453  27.25472791    0.01790383)
(vector   1.70000000   9.98554303  27.22960142    0.01902492)
(vector   1.80000000   9.98379124  27.20474586    0.02014639)
(vector   1.90000000   9.98193913  27.18016015    0.02126826)
(vector   2.00000000   9.97998665  27.15584324    0.02239056)
(vector   2.10000000   9.97793377  27.13179407    0.02351331)
(vector   2.20000000   9.97578044  27.10801165    0.02463654)
(vector   2.30000000   9.97352663  27.08449497    0.02576026)
(vector   2.40000000   9.97117229  27.06124305    0.02688450)
(vector   2.50000000   9.96871737  27.03825495    0.02800928)
(vector   2.60000000   9.96616182  27.01552972    0.02913463)
(vector   2.70000000   9.96350559  26.99306646    0.03026057)
(vector   2.80000000   9.96074863  26.97086425    0.03138712)
(vector   2.90000000   9.95789088  26.94892224    0.03251430)
(vector   3.00000000   9.95493228  26.92723956    0.03364214)
(vector   3.10000000   9.95187277  26.90581537    0.03477067)
(vector   3.20000000   9.94871229  26.88464886    0.03589990)
(vector   3.30000000   9.94545078  26.86373923    0.03702986)
(vector   3.40000000   9.94208816  26.84308570    0.03816057)
(vector   3.50000000   9.93862438  26.82268750    0.03929206)
(vector   3.60000000   9.93505936  26.80254391    0.04042435)
(vector   3.70000000   9.93139303  26.78265419    0.04155746)
(vector   3.80000000   9.92762531  26.76301764    0.04269143)
(vector   3.90000000   9.92375613  26.74363359    0.04382626)
(vector   4.00000000   9.91978541  26.72450135    0.04496199)
(vector   4.10000000   9.91571306  26.70562029    0.04609865)
(vector   4.20000000   9.91153900  26.68698977    0.04723625)
(vector   4.30000000   9.90726315  26.66860919    0.04837482)
(vector   4.40000000   9.90288542  26.65047795    0.04951438)
(vector   4.50000000   9.89840572  26.63259548    0.05065496)
(vector   4.60000000   9.89382395  26.61496122    0.05179659)
(vector   4.70000000   9.88914003  26.59757464    0.05293929)
(vector   4.80000000   9.88435385  26.58043521    0.05408308)
(vector   4.90000000   9.87946532  26.56354244    0.05522800)
(vector   5.00000000   9.87447434  26.54689585    0.05637406)
(vector   5.10000000   9.86938079  26.53049496    0.05752128)
(vector   5.20000000   9.86418458  26.51433934    0.05866971)
(vector   5.30000000   9.85888560  26.49842855    0.05981936)
(vector   5.40000000   9.85348373  26.48276218    0.06097026)
(vector   5.50000000   9.84797887  26.46733985    0.06212243)
(vector   5.60000000   9.84237089  26.45216117    0.06327590)
(vector   5.70000000   9.83665969  26.43722579    0.06443070)
(vector   5.80000000   9.83084514  26.42253337    0.06558686)
(vector   5.90000000   9.82492711  26.40808359    0.06674439)
(vector   6.00000000   9.81890550  26.39387615    0.06790333)
(vector   6.10000000   9.81278015  26.37991076    0.06906371)
(vector   6.20000000   9.80655096  26.36618716    0.07022555)
(vector   6.30000000   9.80021778  26.35270509    0.07138888)
(vector   6.40000000   9.79378048  26.33946433    0.07255372)
(vector   6.50000000   9.78723893  26.32646467    0.07372011)
(vector   6.60000000   9.78059298  26.31370590    0.07488808)
(vector   6.70000000   9.77384250  26.30118785    0.07605764)
(vector   6.80000000   9.76698733  26.28891037    0.07722883)
(vector   6.90000000   9.76002733  26.27687331    0.07840168)
(vector   7.00000000   9.75296236  26.26507655    0.07957622)
(vector   7.10000000   9.74579226  26.25351999    0.08075247)
(vector   7.20000000   9.73851687  26.24220353    0.08193047)
(vector   7.30000000   9.73113604  26.23112712    0.08311024)
(vector   7.40000000   9.72364960  26.22029070    0.08429181)
(vector   7.50000000   9.71605740  26.20969424    0.08547522)
(vector   7.60000000   9.70835927  26.19933774    0.08666050)
(vector   7.70000000   9.70055505  26.18922118    0.08784766)
(vector   7.80000000   9.69264455  26.17934461    0.08903675)
(vector   7.90000000   9.68462761  26.16970806    0.09022780)
(vector   8.00000000   9.67650405  26.16031160    0.09142084)
(vector   8.10000000   9.66827369  26.15115530    0.09261589)
(vector   8.20000000   9.65993636  26.14223927    0.09381299)
(vector   8.30000000   9.65149185  26.13356362    0.09501217)
(vector   8.40000000   9.64294000  26.12512849    0.09621347)
(vector   8.50000000   9.63428060  26.11693405    0.09741691)
(vector   8.60000000   9.62551347  26.10898046    0.09862253)
(vector   8.70000000   9.61663840  26.10126792    0.09983037)
(vector   8.80000000   9.60765520  26.09379665    0.10104045)
(vector   8.90000000   9.59856367  26.08656688    0.10225280)
(vector   9.00000000   9.58936359  26.07957886    0.10346747)
(vector   9.10000000   9.58005477  26.07283288    0.10468449)
(vector   9.20000000   9.57063699  26.06632923    0.10590389)
(vector   9.30000000   9.56111004  26.06006821    0.10712570)
(vector   9.40000000   9.55147369  26.05405018    0.10834996)
(vector   9.50000000   9.54172773  26.04827547    0.10957672)
(vector   9.60000000   9.53187194  26.04274447    0.11080599)
(vector   9.70000000   9.52190608  26.03745758    0.11203782)
(vector   9.80000000   9.51182992  26.03241522    0.11327225)
(vector   9.90000000   9.50164324  26.02761781    0.11450932)
(vector  10.00000000   9.49134580  26.02306583    0.11574905)
(vector  10.10000000   9.48093734  26.01875976    0.11699149)
(vector  10.20000000   9.47041764  26.01470009    0.11823667)
(vector  10.30000000   9.45978644  26.01088736    0.11948464)
(vector  10.40000000   9.44904349  26.00732211    0.12073543)
(vector  10.50000000   9.43818855  26.00400492    0.12198909)
(vector  10.60000000   9.42722134  26.00093637    0.12324564)
(vector  10.70000000   9.41614161  25.99811708    0.12450514)
(vector  10.80000000   9.40494909  25.99554769    0.12576762)
(vector  10.90000000   9.39364352  25.99322886    0.12703312)
(vector  11.00000000   9.38222462  25.99116127    0.12830169)
(vector  11.10000000   9.37069212  25.98934564    0.12957337)
(vector  11.20000000   9.35904574  25.98778270    0.13084820)
(vector  11.30000000   9.34728519  25.98647320    0.13212621)
(vector  11.40000000   9.33541019  25.98541792    0.13340747)
(vector  11.50000000   9.32342044  25.98461768    0.13469200)
(vector  11.60000000   9.31131565  25.98407330    0.13597986)
(vector  11.70000000   9.29909552  25.98378563    0.13727109)
(vector  11.80000000   9.28675975  25.98375557    0.13856573)
(vector  11.90000000   9.27430803  25.98398401    0.13986383)
(vector  12.00000000   9.26174005  25.98447190    0.14116543)
(vector  12.10000000   9.24905548  25.98522019    0.14247059)
(vector  12.20000000   9.23625402  25.98622987    0.14377936)
(vector  12.30000000   9.22333534  25.98750197    0.14509177)
(vector  12.40000000   9.21029911  25.98903751    0.14640788)
(vector  12.50000000   9.19714499  25.99083757    0.14772774)
(vector  12.60000000   9.18387265  25.99290325    0.14905139)
(vector  12.70000000   9.17048175  25.99523569    0.15037890)
(vector  12.80000000   9.15697194  25.99783603    0.15171030)
(vector  12.90000000   9.14334287  26.00070546    0.15304566)
(vector  13.00000000   9.12959418  26.00384521    0.15438502)
(vector  13.10000000   9.11572552  26.00725652    0.15572844)
(vector  13.20000000   9.10173651  26.01094066    0.15707597)
(vector  13.30000000   9.08762679  26.01489895    0.15842767)
(vector  13.40000000   9.07339598  26.01913274    0.15978359)
(vector  13.50000000   9.05904371  26.02364338    0.16114378)
(vector  13.60000000   9.04456958  26.02843230    0.16250831)
(vector  13.70000000   9.02997320  26.03350093    0.16387724)
(vector  13.80000000   9.01525419  26.03885075    0.16525062)
(vector  13.90000000   9.00041214  26.04448327    0.16662850)
(vector  14.00000000   8.98544664  26.05040002    0.16801096)
(vector  14.10000000   8.97035729  26.05660259    0.16939805)
(vector  14.20000000   8.95514366  26.06309260    0.17078983)
(vector  14.30000000   8.93980533  26.06987169    0.17218637)
(vector  14.40000000   8.92434188  26.07694156    0.17358773)
(vector  14.50000000   8.90875287  26.08430393    0.17499398)
(vector  14.60000000   8.89303786  26.09196057    0.17640517)
(vector  14.70000000   8.87719640  26.09991329    0.17782138)
(vector  14.80000000   8.86122805  26.10816392    0.17924268)
(vector  14.90000000   8.84513234  26.11671437    0.18066913)
(vector  15.00000000   8.82890882  26.12556654    0.18210080)
(vector  15.10000000   8.81255701  26.13472242    0.18353776)
(vector  15.20000000   8.79607643  26.14418401    0.18498008)
(vector  15.30000000   8.77946660  26.15395338    0.18642784)
(vector  15.40000000   8.76272704  26.16403261    0.18788111)
(vector  15.50000000   8.74585724  26.17442387    0.18933997)
(vector  15.60000000   8.72885670  26.18512933    0.19080448)
(vector  15.70000000   8.71172492  26.19615124    0.19227474)
(vector  15.80000000   8.69446138  26.20749188    0.19375081)
(vector  15.90000000   8.67706555  26.21915360    0.19523278)
(vector  16.00000000   8.65953690  26.23113877    0.19672072)
(vector  16.10000000   8.64187490  26.24344983    0.19821472)
(vector  16.20000000   8.62407899  26.25608927    0.19971487)
(vector  16.30000000   8.60614863  26.26905962    0.20122124)
(vector  16.40000000   8.58808325  26.28236350    0.20273392)
(vector  16.50000000   8.56988229  26.29600353    0.20425301)
(vector  16.60000000   8.55154517  26.30998243    0.20577859)
(vector  16.70000000   8.53307130  26.32430297    0.20731075)
(vector  16.80000000   8.51446010  26.33896795    0.20884958)
(vector  16.90000000   8.49571095  26.35398027    0.21039518)
(vector  17.00000000   8.47682326  26.36934285    0.21194764)
(vector  17.10000000   8.45779640  26.38505871    0.21350706)
(vector  17.20000000   8.43862974  26.40113092    0.21507354)
(vector  17.30000000   8.41932266  26.41756259    0.21664718)
(vector  17.40000000   8.39987450  26.43435694    0.21822808)
(vector  17.50000000   8.38028462  26.45151722    0.21981634)
(vector  17.60000000   8.36055234  26.46904678    0.22141207)
(vector  17.70000000   8.34067699  26.48694900    0.22301538)
(vector  17.80000000   8.32065790  26.50522738    0.22462638)
(vector  17.90000000   8.30049437  26.52388546    0.22624518)
(vector  18.00000000   8.28018570  26.54292686    0.22787188)
(vector  18.10000000   8.25973117  26.56235530    0.22950662)
(vector  18.20000000   8.23913006  26.58217456    0.23114950)
(vector  18.30000000   8.21838165  26.60238849    0.23280065)
(vector  18.40000000   8.19748517  26.62300105    0.23446019)
(vector  18.50000000   8.17643988  26.64401626    0.23612824)
(vector  18.60000000   8.15524501  26.66543824    0.23780493)
(vector  18.70000000   8.13389978  26.68727120    0.23949038)
(vector  18.80000000   8.11240340  26.70951944    0.24118474)
(vector  18.90000000   8.09075507  26.73218734    0.24288814)
(vector  19.00000000   8.06895398  26.75527939    0.24460070)
(vector  19.10000000   8.04699929  26.77880018    0.24632258)
(vector  19.20000000   8.02489017  26.80275438    0.24805391)
(vector  19.30000000   8.00262577  26.82714678    0.24979484)
(vector  19.40000000   7.98020522  26.85198228    0.25154553)
(vector  19.50000000   7.95762764  26.87726587    0.25330611)
(vector  19.60000000   7.93489215  26.90300267    0.25507674)
(vector  19.70000000   7.91199782  26.92919788    0.25685759)
(vector  19.80000000   7.88894376  26.95585686    0.25864881)
(vector  19.90000000   7.86572901  26.98298506    0.26045056)
(vector  20.00000000   7.84235262  27.01058806    0.26226302)
(vector  20.10000000   7.81881365  27.03867157    0.26408635)
(vector  20.20000000   7.79511109  27.06724142    0.26592074)
(vector  20.30000000   7.77124396  27.09630358    0.26776635)
(vector  20.40000000   7.74721125  27.12586416    0.26962337)
(vector  20.50000000   7.72301192  27.15592939    0.27149200)
(vector  20.60000000   7.69864493  27.18650568    0.27337241)
(vector  20.70000000   7.67410922  27.21759954    0.27526480)
(vector  20.80000000   7.64940371  27.24921767    0.27716937)
(vector  20.90000000   7.62452729  27.28136690    0.27908633)
(vector  21.00000000   7.59947885  27.31405425    0.28101588)
(vector  21.10000000   7.57425726  27.34728688    0.28295824)
(vector  21.20000000   7.54886135  27.38107213    0.28491363)
(vector  21.30000000   7.52328996  27.41541750    0.28688225)
(vector  21.40000000   7.49754189  27.45033069    0.28886436)
(vector  21.50000000   7.47161593  27.48581958    0.29086017)
(vector  21.60000000   7.44551083  27.52189222    0.29286993)
(vector  21.70000000   7.41922534  27.55855689    0.29489388)
(vector  21.80000000   7.39275818  27.59582204    0.29693228)
(vector  21.90000000   7.36610804  27.63369635    0.29898537)
(vector  22.00000000   7.33927360  27.67218870    0.30105343)
(vector  22.10000000   7.31225351  27.71130819    0.30313671)
(vector  22.20000000   7.28504640  27.75106417    0.30523551)
(vector  22.30000000   7.25765085  27.79146620    0.30735009)
(vector  22.40000000   7.23006546  27.83252408    0.30948075)
(vector  22.50000000   7.20228877  27.87424789    0.31162779)
(vector  22.60000000   7.17431929  27.91664793    0.31379152)
(vector  22.70000000   7.14615553  27.95973478    0.31597224)
(vector  22.80000000   7.11779594  28.00351932    0.31817027)
(vector  22.90000000   7.08923897  28.04801267    0.32038596)
(vector  23.00000000   7.06048302  28.09322627    0.32261963)
(vector  23.10000000   7.03152647  28.13917186    0.32487163)
(vector  23.20000000   7.00236766  28.18586149    0.32714232)
(vector  23.30000000   6.97300491  28.23330752    0.32943207)
(vector  23.40000000   6.94343648  28.28152266    0.33174126)
(vector  23.50000000   6.91366064  28.33051997    0.33407026)
(vector  23.60000000   6.88367557  28.38031285    0.33641948)
(vector  23.70000000   6.85347947  28.43091507    0.33878934)
(vector  23.80000000   6.82307047  28.48234082    0.34118024)
(vector  23.90000000   6.79244666  28.53460463    0.34359262)
(vector  24.00000000   6.76160610  28.58772148    0.34602694)
(vector  24.10000000   6.73054681  28.64170677    0.34848364)
(vector  24.20000000   6.69926677  28.69657632    0.35096320)
(vector  24.30000000   6.66776391  28.75234644    0.35346611)
(vector  24.40000000   6.63603612  28.80903390    0.35599287)
(vector  24.50000000   6.60408124  28.86665594    0.35854399)
(vector  24.60000000   6.57189708  28.92523035    0.36112001)
(vector  24.70000000   6.53948137  28.98477542    0.36372148)
(vector  24.80000000   6.50683182  29.04531000    0.36634896)
(vector  24.90000000   6.47394608  29.10685352    0.36900304)
(vector  25.00000000   6.44082174  29.16942599    0.37168431)
(vector  25.10000000   6.40745634  29.23304806    0.37439342)
(vector  25.20000000   6.37384736  29.29774100    0.37713098)
(vector  25.30000000   6.33999223  29.36352675    0.37989768)
(vector  25.40000000   6.30588831  29.43042796    0.38269420)
(vector  25.50000000   6.27153290  29.49846801    0.38552124)
(vector  25.60000000   6.23692324  29.56767100    0.38837954)
(vector  25.70000000   6.20205650  29.63806186    0.39126986)
(vector  25.80000000   6.16692979  29.70966630    0.39419298)
(vector  25.90000000   6.13154012  29.78251092    0.39714972)
(vector  26.00000000   6.09588446  29.85662318    0.40014093)
(vector  26.10000000   6.05995968  29.93203151    0.40316746)
(vector  26.20000000   6.02376259  30.00876527    0.40623023)
(vector  26.30000000   5.98728990  30.08685487    0.40933017)
(vector  26.40000000   5.95053824  30.16633176    0.41246826)
(vector  26.50000000   5.91350417  30.24722851    0.41564550)
(vector  26.60000000   5.87618412  30.32957884    0.41886294)
(vector  26.70000000   5.83857446  30.41341772    0.42212168)
(vector  26.80000000   5.80067143  30.49878135    0.42542284)
(vector  26.90000000   5.76247121  30.58570730    0.42876759)
(vector  27.00000000   5.72396982  30.67423451    0.43215716)
(vector  27.10000000   5.68516321  30.76440341    0.43559283)
(vector  27.20000000   5.64604719  30.85625597    0.43907591)
(vector  27.30000000   5.60661747  30.94983576    0.44260779)
(vector  27.40000000   5.56686960  31.04518807    0.44618990)
(vector  27.50000000   5.52679905  31.14235996    0.44982374)
(vector  27.60000000   5.48640110  31.24140039    0.45351088)
(vector  27.70000000   5.44567092  31.34236029    0.45725295)
(vector  27.80000000   5.40460352  31.44529266    0.46105165)
(vector  27.90000000   5.36319375  31.55025274    0.46490877)
(vector  28.00000000   5.32143631  31.65729805    0.46882617)
(vector  28.10000000   5.27932572  31.76648858    0.47280580)
(vector  28.20000000   5.23685632  31.87788690    0.47684970)
(vector  28.30000000   5.19402227  31.99155831    0.48096002)
(vector  28.40000000   5.15081753  32.10757100    0.48513900)
(vector  28.50000000   5.10723585  32.22599625    0.48938898)
(vector  28.60000000   5.06327078  32.34690855    0.49371245)
(vector  28.70000000   5.01891562  32.47038585    0.49811200)
(vector  28.80000000   4.97416345  32.59650975    0.50259037)
(vector  28.90000000   4.92900708  32.72536574    0.50715041)
(vector  29.00000000   4.88343910  32.85704342    0.51179518)
(vector  29.10000000   4.83745176  32.99163680    0.51652785)
(vector  29.20000000   4.79103706  33.12924455    0.52135179)
(vector  29.30000000   4.74418669  33.26997035    0.52627057)
(vector  29.40000000   4.69689198  33.41392321    0.53128794)
(vector  29.50000000   4.64914395  33.56121780    0.53640787)
(vector  29.60000000   4.60093324  33.71197491    0.54163458)
(vector  29.70000000   4.55225010  33.86632186    0.54697255)
(vector  29.80000000   4.50308436  34.02439293    0.55242649)
(vector  29.90000000   4.45342544  34.18632995    0.55800147)
(vector  30.00000000   4.40326226  34.35228280    0.56370282)
(vector  30.10000000   4.35258327  34.52241004    0.56953626)
(vector  30.20000000   4.30137640  34.69687963    0.57550787)
(vector  30.30000000   4.24962898  34.87586962    0.58162415)
(vector  30.40000000   4.19732778  35.05956899    0.58789204)
(vector  30.50000000   4.14445891  35.24817855    0.59431898)
(vector  30.60000000   4.09100779  35.44191195    0.60091294)
(vector  30.70000000   4.03695911  35.64099677    0.60768249)
(vector  30.80000000   3.98229674  35.84567576    0.61463683)
(vector  30.90000000   3.92700372  36.05620820    0.62178588)
(vector  31.00000000   3.87106217  36.27287143    0.62914035)
(vector  31.10000000   3.81445321  36.49596252    0.63671181)
(vector  31.20000000   3.75715686  36.72580022    0.64451281)
(vector  31.30000000   3.69915200  36.96272710    0.65255695)
(vector  31.40000000   3.64041624  37.20711194    0.66085903)
(vector  31.50000000   3.58092578  37.45935245    0.66943520)
(vector  31.60000000   3.52065533  37.71987842    0.67830308)
(vector  31.70000000   3.45957796  37.98915520    0.68748200)
(vector  31.80000000   3.39766491  38.26768773    0.69699316)
(vector  31.90000000   3.33488543  38.55602514    0.70685992)
(vector  32.00000000   3.27120659  38.85476604    0.71710808)
(vector  32.10000000   3.20659302  39.16456468    0.72776623)
(vector  32.20000000   3.14100665  39.48613799    0.73886615)
(vector  32.30000000   3.07440640  39.82027388    0.75044327)
(vector  32.40000000   3.00674787  40.16784093    0.76253730)
(vector  32.50000000   2.93798285  40.52979977    0.77519285)
(vector  32.60000000   2.86805892  40.90721661    0.78846032)
(vector  32.70000000   2.79691884  41.30127933    0.80239687)
(vector  32.80000000   2.72449992  41.71331677    0.81706768)
(vector  32.90000000   2.65073322  42.14482201    0.83254746)
(vector  33.00000000   2.57554263  42.59748081    0.84892240)
(vector  33.10000000   2.49884371  43.07320638    0.86629252)
(vector  33.20000000   2.42054237  43.57418255    0.88477476)
(vector  33.30000000   2.34053315  44.10291773    0.90450688)
(vector  33.40000000   2.25869715  44.66231318    0.92565261)
(vector  33.50000000   2.17489942  45.25575050    0.94840837)
(vector  33.60000000   2.08898565  45.88720508    0.97301237)
(vector  33.70000000   2.00077792  46.56139566    0.99975696)
(vector  33.80000000   1.91006912  47.28398488    1.02900591)
(vector  33.90000000   1.81661551  48.06185332    1.06121889)
(vector  34.00000000   1.72012669  48.90348244    1.09698738)
(vector  34.10000000   1.62025153  49.81950374    1.13708852)
(vector  34.20000000   1.51655812  50.82351015    1.18256908)
(vector  34.30000000   1.40850406  51.93329879    1.23488168)
(vector  34.40000000   1.29539075  53.17285813    1.29611712)
(vector  34.50000000   1.17628940  54.57572030    1.36942591)
(vector  34.60000000   1.04991366  56.19101265    1.45984526)
(vector  34.70000000   0.91438143  58.09540175    1.57609923)
(vector  34.80000000   0.76671596  60.41976940    1.73512533)
(vector  34.90000000   0.60160811  63.42092131    1.97624116)
(vector  35.00000000   0.40731379  67.74728635    2.42647357)
(vector  35.10000000   0.13726723  76.75214850    4.23823660)
(vector  35.12397366   0.00355664  87.83966794   0.0)
))

;(display (vector-length posList))
;(display "\n")
;(display (vector-ref (vector-ref posList 100) 1))
;(display "\n")
;(display (vector-ref (vector-ref posList 100) 2))
;(exit)

(init-metric '(type "EddFinkIn")
             '(mass 1.0)
             '(id "metric")
)

(init-solver '(type  "GSL_RK_Cash-Karp")
             '(geodType "lightlike")
             '(eps_abs 1e-8)
             '(step_size 0.01)
             '(id "raytracing")
)

(init-camera '(type "PinHoleCam")
             '(dir #( 1.0 0.0 0.0 ))
             '(vup #( 0.0 0.0 1.0 ))
             '(fov #( 40.0 40.0 ))
             '(res #( 50 50 ))
             ;'(res #( 200 200 ))
             '(filter "FilterRGB")
             '(id "cam")
)

(init-camera '(type "PanoramaCam")
         `(dir #( 1.0 0.0 0.0) )
         '(vup #( 0.0 0.0 1.0) )
         '(fov #( 360.0 80.0 ))
         ;'(res #( 2250 500 ))
         '(res #(360 80))
         '(filter "FilterRGB")
         '(id "pancam")
)


(init-raygen '(type       "RayGenSimple")
             `(boundBoxLL  ,(vector (- gpDBLMAX)   0.0 (- gpDBLMAX) (- gpDBLMAX)) )
             `(boundBoxUR  ,(vector   gpDBLMAX    70.0  gpDBLMAX gpDBLMAX) )
             '(solver "raytracing")
             '(maxNumPoints 3000)
)

; ------------------------------------------------
;    observer tetrad
;      falling tetrad starting from initial pos
; ------------------------------------------------
(define rs 2.0)

; Schwarzschild time depending on current position
(define coord_v
    (lambda (r)
        (define w1 (sqrt (- (/ obsInitPos rs) 1.0)))
        (define w2 (sqrt (- (/ obsInitPos r) 1.0)))
        (define w3 (sqrt (- (/ rs r) (/ rs obsInitPos))))
        (define w4 (sqrt (- 1.0 (/ rs obsInitPos))))
        (define a  (atan w2))
        (define ah (atanh (/ w3 w4)))
        (define p1 (* (* rs (* w1 (+ 2.0 (/ obsInitPos rs)))) a))
        (define p2 (* (* (* r (/ obsInitPos rs)) w4) w3))
        (define p3 (* 2.0 (* rs ah)))
        (define t (+ (+ p1 p2) p3))
        (+ t (+ r (* rs (log (- r rs)))))
    )
)

; first basis vector of falling tetrad
(define e0ef
    (lambda (r) 
        (define w1 (sqrt (- 1.0 (/ rs obsInitPos))))
        (define w2 (sqrt (- (/ rs r) (/ rs obsInitPos))))
        (define c0 (/ (- w1 w2) (- 1.0 (/ rs r)) ))
        (vector c0 (- w2) 0.0 0.0)
    )
)

; second basis vector of falling tetrad
(define e1ef
    (lambda (r)
        (define w1 (sqrt (- 1.0 (/ rs obsInitPos))))
        (define w2 (sqrt (- (/ rs r) (/ rs obsInitPos))))
        (define w3 (sqrt (- 1.0 (/ rs obsInitPos))))
        (define c0 (/ (- w1 w2) (- 1.0 (/ rs r)) ))
        (vector (- c0) (- w3) 0.0 0.0)
    )
)

;(display (e0ef 10.0))
;(display (vector-ref  w2 1))


(local-tetrad `(pos ,(vector 0.0  obsInitPos PIhalf 0.0))
              '(e0 #( 1.0  0.0  0.0  0.0 ))
              '(e1 #( 0.0 -1.0  0.0  0.0 ))
              '(e2 #( 0.0  0.0  0.0  1.0 ))
              '(e3 #( 0.0  0.0 -1.0  0.0 ))
              '(incoords #f)
              '(id "locTedObsNat")
)

(define curr_r  6.0)
(local-tetrad `(pos ,(vector 0.0 curr_r PIhalf 0.0))
              `(e0 ,(e0ef curr_r))
              `(e1 ,(e1ef curr_r))
              `(e2 ,(vector 0.0 0.0 0.0 (- (/ 1.0 curr_r))))
              `(e3 ,(vector 0.0 0.0 (/ 1.0 curr_r) 0.0))
              '(incoords #t)
              '(id "locTedObsFall")
)

; ------------------------------------------------
;    textures and shaders
; ------------------------------------------------
(init-texture '(type "UniTex")
              '(color #(0.8 0.16 0.16))
              '(id "utex1")
)

(init-texture '(type "UniTex")
              '(color #(0.9 0.63 0.63))
              '(id "utex2")
)

(init-shader  '(type "SurfShader")
              `(objcolor ,(init-texture '(type "CheckerT2D")
                                        '(texture "utex1")
                                        '(texture "utex2")
                                        `(transform ,(scale-obj #(20.0 10.0)))
                          )
               )
              '(ambient 0.4)
              '(diffuse 1.0)
              '(id "checkShader")
)

(define homedir (getenv "HOME"))
(define background_image_name (string-append homedir "/local/Texturen/MilkyWay/eso0932a.tif"))
(init-shader  '(type "SurfShader")
              `(objcolor ,(init-texture '(type "Image")
                                        `(file ,background_image_name)
                                        `(transform ,(scale-obj #(-1.0 -1.0)))
                                        )
                         )
              '(ambient 1.0)
              '(id "bgShader")
)

; ------------------------------------------------
;    background sphere
; ------------------------------------------------
(solid-ellipsoid `(objtype ,gpObjTypeInCoords)
                 '(center #( 0.0 0.0 0.0 ))
                 '(axlen  #(60.0 60.0 60.0 ))
                 `(transform ,(rotate-obj "z" 0.0))
                 '(shader "bgShader")
                 '(id "bgSphere")
)

; ------------------------------------------------
;    falling sphere
; ------------------------------------------------
(local-tetrad `(pos ,(vector 0.0 objInitPos PIhalf 0.0 ))
              '(e0 #(1.0 0.0 0.0 0.0))
              '(e1 #(0.0 0.0 -1.0 0.0))
              '(e2 #(0.0 0.0 0.0 -1.0))
              '(e3 #(0.0 1.0 0.0 0.0))
              '(incoords #f) 
              '(id  "locTedSphere")
)

(solid-ellipsoid `(objtype ,gpObjTypeLocal)
                 '(center #( 0.0 0.0 0.0))
                 '(axlen  #( 1.5 1.5 1.5))
                 '(shader "checkShader")
                 '(id "sphere")
)

; ------------------------------------------------
;    scene graph
; ------------------------------------------------
(init-projector '(localTetrad "locTedObsFall")
                '(color #( 0.0 0.0 0.0 ))
                '(id "proj")
)

(init-light-mgr '(ambient #( 1.0 1.0 1.0 )))

(local-comp-object '(obj "sphere")
                   '(localTetrad "locTedSphere")
                   '(id "lco")
)

(comp-object '(obj "bgSphere")
             ;'(obj "lco")
             '(id "scene")
)

(do ((count 0 (+ count 1))) ((= count (vector-length posList)))
    (define r (vector-ref (vector-ref posList count) 1))
    (define v (coord_v r))
    ;(display r)
    ;(display "\n")
    ; device type must be manual to set the tetrad vectors
    ; without adjusting the tetrad within GvsDevice::makeChange().
    (init-device '(type "standard_manual")
                 '(obj "scene")
                 '(camera "pancam")
                 `(setparam ("locTedObsFall" "pos" ,(vector 0.0 r PIhalf 0.0)))
                 `(setparam ("locTedObsFall" "e0"  ,(e0ef r)))
                 `(setparam ("locTedObsFall" "e1"  ,(e1ef r)))
                 `(setparam ("locTedObsFall" "e2"  ,(vector 0.0 0.0 0.0 (- (/ 1.0 r)))))
                 `(setparam ("locTedObsFall" "e3"  ,(vector 0.0 0.0 (/ 1.0 r) 0.0)))
                 `(setparam ("locTedObsFall" "calc" 1))
    )
)



